TRANSLATIONS = {
    "uz": {
        "welcome": "🎓 EduBot.ai ga xush kelibsiz!\n\nAkademik hujjatlar yaratish uchun tilni tanlang:",
        "language_selected": "📝 Til tanlandi: O'zbek\n\nBot ishga tayyor! Quyidagi tugmalar orqali xizmatlardan foydalaning:",
        "channel_subscription_required": "📢 Botdan foydalanish uchun quyidagi kanallarga a'zo bo'lishingiz shart:",
        "check_subscription": "✅ Tekshirish",
        "subscription_verified": "✅ A'zolik tasdiqlandi! Botdan foydalanishingiz mumkin.",
        "subscription_not_verified": "❌ Siz hali kanallarga a'zo bo'lmagan. Iltimos, a'zo bo'ling va qayta tekshiring.",
        "main_menu": {
            "presentation": "📊 Taqdimot",
            "independent_work": "🎓 Mustaqil ish",
            "referat": "📄 Referat",
            "my_account": "💰 Mening hisobim",
            "payment": "💳 To'lov qilish",
            "help": "📞 Yordam",
            "settings": "⚙️ Sozlamalar"
        },
        "enter_topic": "📝 Mavzuni kiriting:",
        "select_slide_count": "📊 Slaydlar sonini tanlang:",
        "select_page_count": "📄 Varoqlar sonini tanlang:",
        "generating": "⏳ Yaratilmoqda... Iltimos kuting.",
        "document_ready": "✅ Hujjat tayyor!",
        "balance_info": "💰 Hisobingiz:\n\n💵 Balans: {balance} so'm\n🎁 Bepul xizmat: {free_service}",
        "insufficient_balance": "❌ Hisobingizda mablag' yetarli emas. To'lov qiling.",
        "select_payment_amount": "💳 To'lov miqdorini tanlang:",
        "payment_instructions": "💳 To'lov qilish uchun:\n\n1. Quyidagi karta raqamiga pul o'tkazing:\n{card}\n\n2. To'lov chekini yuboring:",
        "payment_sent_to_admin": "📤 To'lov so'rovi adminga yuborildi. Tekshirilgandan keyin hisobingizga qo'shiladi.",
        "payment_approved": "✅ To'lovingiz tasdiqlandi! {amount} so'm hisobingizga qo'shildi.",
        "payment_rejected": "❌ To'lovingiz rad etildi. Iltimos, qayta urinib ko'ring.",
        "free_service_used": "🎁 Bepul xizmatdan foydalandingiz!",
        "promocode_applied": "🎁 Promokod qo'llandi! Xizmat bepul.",
        "help_text": "🆘 Yordam\n\n📊 Taqdimot - AI yordamida taqdimot yaratish (3000 som)\n🎓 Mustaqil ish - DOCX formatda mustaqil ish (5000 som)\n📄 Referat - DOCX formatda referat (4000 som)\n💰 Hisobim - balans va bepul xizmatlar\n💳 To'lov - mablag' to'ldirish\n⚙️ Sozlamalar - tilni o'zgartirish va promokod",
        "settings_menu": "⚙️ Sozlamalar\n\nTilni o'zgartirish:",
        "language_changed": "✅ Til o'zgartirildi!",
        "help_message": "📞 Yordam va ma'lumotlar"
    },
    "ru": {
        "welcome": "🎓 Добро пожаловать в EduBot.ai!\n\nВыберите язык для создания академических документов:",
        "language_selected": "📝 Язык выбран: Русский\n\nБот готов к работе! Используйте кнопки ниже для доступа к услугам:",
        "channel_subscription_required": "📢 Для использования бота необходимо подписаться на следующие каналы:",
        "check_subscription": "✅ Проверить",
        "subscription_verified": "✅ Подписка подтверждена! Вы можете использовать бота.",
        "subscription_not_verified": "❌ Вы еще не подписались на каналы. Пожалуйста, подпишитесь и проверьте снова.",
        "main_menu": {
            "presentation": "📊 Презентация",
            "independent_work": "🎓 Самостоятельная работа",
            "referat": "📄 Реферат",
            "my_account": "💰 Мой счет",
            "payment": "💳 Оплата",
            "help": "📞 Yordam",
            "settings": "⚙️ Настройки"
        },
        "enter_topic": "📝 Введите тему:",
        "select_slide_count": "📊 Выберите количество слайдов:",
        "select_page_count": "📄 Выберите количество страниц:",
        "generating": "⏳ Создается... Пожалуйста, подождите.",
        "document_ready": "✅ Документ готов!",
        "balance_info": "💰 Ваш счет:\n\n💵 Баланс: {balance} сум\n🎁 Бесплатная услуга: {free_service}",
        "insufficient_balance": "❌ Недостаточно средств на счете. Пополните баланс.",
        "select_payment_amount": "💳 Выберите сумму платежа:",
        "payment_instructions": "💳 Для оплаты:\n\n1. Переведите деньги на карту:\n{card}\n\n2. Отправьте чек об оплате:",
        "payment_sent_to_admin": "📤 Запрос на оплату отправлен администратору. После проверки сумма будет добавлена на ваш счет.",
        "payment_approved": "✅ Ваш платеж подтвержден! {amount} сум добавлено на ваш счет.",
        "payment_rejected": "❌ Ваш платеж отклонен. Пожалуйста, попробуйте снова.",
        "free_service_used": "🎁 Вы воспользовались бесплатной услугой!",
        "promocode_applied": "🎁 Промокод применен! Услуга бесплатна.",
        "help_text": "🆘 Помощь\n\n📊 Презентация - создание презентации с помощью ИИ (3000 сум)\n🎓 Самостоятельная работа - создание работы в формате DOCX (5000 сум)\n📄 Реферат - создание реферата в формате DOCX (4000 сум)\n💰 Мой счет - баланс и бесплатные услуги\n💳 Оплата - пополнение баланса\n⚙️ Настройки - изменение языка и промокод",
        "settings_menu": "⚙️ Настройки\n\nИзменить язык:",
        "language_changed": "✅ Язык изменен!",
        "help_message": "📞 Yordam va ma'lumotlar"
    },
    "en": {
        "welcome": "🎓 Welcome to EduBot.ai!\n\nSelect language for creating academic documents:",
        "language_selected": "📝 Language selected: English\n\nBot is ready! Use the buttons below to access services:",
        "channel_subscription_required": "📢 To use the bot, you must subscribe to the following channels:",
        "check_subscription": "✅ Check",
        "subscription_verified": "✅ Subscription verified! You can use the bot.",
        "subscription_not_verified": "❌ You haven't subscribed to the channels yet. Please subscribe and check again.",
        "main_menu": {
            "presentation": "📊 Presentation",
            "independent_work": "🎓 Independent Work",
            "referat": "📄 Research Paper",
            "my_account": "💰 My Account",
            "payment": "💳 Payment",
            "help": "📞 Yordam",
            "settings": "⚙️ Settings"
        },
        "enter_topic": "📝 Enter topic:",
        "select_slide_count": "📊 Select number of slides:",
        "select_page_count": "📄 Select number of pages:",
        "generating": "⏳ Generating... Please wait.",
        "document_ready": "✅ Document is ready!",
        "balance_info": "💰 Your account:\n\n💵 Balance: {balance} som\n🎁 Free service: {free_service}",
        "insufficient_balance": "❌ Insufficient balance. Please make a payment.",
        "select_payment_amount": "💳 Select payment amount:",
        "payment_instructions": "💳 To pay:\n\n1. Transfer money to the card:\n{card}\n\n2. Send payment receipt:",
        "payment_sent_to_admin": "📤 Payment request sent to admin. After verification, the amount will be added to your account.",
        "payment_approved": "✅ Your payment has been approved! {amount} som added to your account.",
        "payment_rejected": "❌ Your payment was rejected. Please try again.",
        "free_service_used": "🎁 You used the free service!",
        "promocode_applied": "🎁 Promocode applied! Service is free.",
        "help_text": "🆘 Help\n\n📊 Presentation - create AI-powered presentations (3000 som)\n🎓 Independent Work - create work in DOCX format (5000 som)\n📄 Research Paper - create paper in DOCX format (4000 som)\n💰 My Account - balance and free services\n💳 Payment - top up balance\n⚙️ Settings - change language and promocode",
        "settings_menu": "⚙️ Settings\n\nChange language:",
        "language_changed": "✅ Language changed!",
        "help_message": "📞 Yordam va ma'lumotlar"
    }
}

def get_text(lang: str, key: str, **kwargs) -> str:
    """Get translated text by language and key"""
    keys = key.split('.')
    text = TRANSLATIONS.get(lang, TRANSLATIONS['en'])

    for k in keys:
        if isinstance(text, dict):
            text = text.get(k, key)
        else:
            return key

    if kwargs:
        try:
            return text.format(**kwargs)
        except:
            return text

    return text